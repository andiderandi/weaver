selection:
   ### use `&`, `|`, `~` for logical operations on numpy arrays
   ### can use functions from `math`, `np` (numpy), and `awkward` in the expression
   (lepton_pt>20) & (lepton_pt<1000) & (lepton_eta>-2.4) & (lepton_eta<2.4) #& ((label_Muon_Prompt + label_Muon_unknown) > 0)

new_variables:
   ### [format] name: formula
   ### can use functions from `math`, `np` (numpy), and `awkward` in the expression
   pfcand_mask: awkward.JaggedArray.ones_like(PFCand_eta_rel)
   sv_mask: awkward.JaggedArray.ones_like(SV_eta_rel)
   #lep_mask: np.ones_like(lepton_eta)

preprocess:
  ### method: [manual, auto] - whether to use manually specified parameters for variable standardization
  method: manual
  ### data_fraction: fraction of events to use when calculating the mean/scale for the standardization
  data_fraction: 

inputs:
   pf_points:
      length: 100
      vars: 
         - PFCand_eta_rel
         - PFCand_phiAtVtx_rel
   pf_features:
      length: 100
      vars: 
      ### [format 1]: var_name (no transformation)
      ### [format 2]: [var_name, 
      ###              subtract_by(optional, default=None, no transf. if preprocess.method=manual, auto transf. if preprocess.method=auto), 
      ###              multiply_by(optional, default=1), 
      ###              clip_min(optional, default=-5), 
      ###              clip_max(optional, default=5), 
      ###              pad_value(optional, default=0)]
         - PFCand_eta_rel
         - PFCand_phiAtVtx_rel
         - PFCand_deltaR
         - PFCand_puppiWeightNoLep
         - PFCand_dzSig
         - PFCand_dxySig
   pf_mask:
      length: 100
      vars: 
         - pfcand_mask
   sv_points:
      length: 10
      vars:
         - SV_eta_rel 
         - SV_phi_rel
   sv_features:
      length: 10
      vars:
         - SV_eta_rel
         - SV_phi_rel
         - SV_deltaR
         - SV_ndof
         - SV_pt_rel
         - SV_mass
         - SV_dxy
         - SV_ntracks
         - SV_d3dSig

   sv_mask:
      length: 10
      vars:
         - sv_mask
 
   lep_features:
      length: 1
      vars:
         - lepton_chi2
         - lepton_dxy
         - lepton_dxyError
         - lepton_dxySig
         - lepton_dz
         - lepton_dzError
         - lepton_dzSig
         - lepton_e_ECAL
         - lepton_e_HCAL
         - lepton_hit
         - lepton_hoe
         - lepton_ip3d
         - lepton_jetbtag
         - lepton_jetPtRelv2_log
         - lepton_lostHits
         - lepton_ndof
         - lepton_nStations
         - lepton_nTrackerLayers
         - lepton_pixhit
         - lepton_posmatch
         - lepton_segmentComp
         - lepton_sip3d
         - lepton_isGoodGlobal
         - lepton_isHighPt


 
labels:
   ### type can be `simple`, `custom`
   ### [option 1] use `simple` for binary/multi-class classification, then `value` is a list of 0-1 labels
   type: simple
   value: [
      label_Muon_Prompt, label_Muon_fromTau, label_Muon_fromHFHadron, label_Muon_fromLFHadron, label_Muon_unknown, label_Muon_fromPhoton
      ]
   ### [option 2] otherwise use `custom` to define the label, then `value` is a map
   # type: custom
   # value: 
      # target_mass: np.where(fj_isQCD, fj_genjet_sdmass, fj_gen_mass) 

observers:
   - nPFCand
   - lepton_pt

weights:
   ### [option 1] use precomputed weights stored in the input files
   # use_precomputed_weights: true
   # weight_branches: [weight, class_weight]
   ### [option 2] compute weights on-the-fly using reweighting histograms
   use_precomputed_weights: false

   reweight_method: flat
   reweight_vars:
      lepton_pt: [20, 50, 100, 200, 1000]
      lepton_eta: [-2.4, 0, 2.4]
   reweight_classes: [label_Muon_Prompt, label_Muon_unknown] #, label_Electron_Prompt, label_Electron_fromTau, label_Electron_fromHFHadron, label_Electron_fromLFHadron, label_Electron_unknown]
   class_weights: [1, 1]
   reweight_hists:
